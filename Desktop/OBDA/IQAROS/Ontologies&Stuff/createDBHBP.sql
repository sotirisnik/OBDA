#create database npd;
#use npd;

 SELECT T1.obj, T2.obj, T0.obj FROM (SELECT CONCAT( 'http://sws.ifi.uio.no/data/npd-v2/licence/', prlNpdidLicence, '/licensee/', cmpNpdidCompany, '/history/', prlLicenseeDateValidFrom, '/', prlLicenseeDateValidTo ) AS subject, prlLicenseeDateValidFrom AS obj FROM licence_licensee_hst WHERE prlLicenseeDateValidFrom <> '9999-12-31T00:00:00') AS T0, (SELECT CONCAT( 'http://sws.ifi.uio.no/data/npd-v2/licence/', licence_licensee_hst.prlNpdidLicence, '/licensee/', licence_licensee_hst.cmpNpdidCompany, '/history/', licence_licensee_hst.prlLicenseeDateValidFrom, '/', licence_licensee_hst.prlLicenseeDateValidTo ) AS subject,CONCAT( 'http://sws.ifi.uio.no/data/npd-v2/licence/', licence.prlNpdidLicence ) AS obj FROM licence_licensee_hst INNER JOIN licence ON licence_licensee_hst.prlNpdidLicence = licence.prlNpdidLicence) AS T1, (SELECT CONCAT( 'http://sws.ifi.uio.no/data/npd-v2/licence/', prlNpdidLicence, '/licensee/', cmpNpdidCompany, '/history/', prlLicenseeDateValidFrom, '/', prlLicenseeDateValidTo ) AS subject, prlLicenseeInterest AS obj FROM licence_licensee_hst UNION SELECT CONCAT( 'http://sws.ifi.uio.no/data/npd-v2/baa/', baaNpdidBsnsArrArea, '/licensee/', cmpNpdidCompany, '/history/', baaLicenseeDateValidFrom, '/', baaLicenseeDateValidTo ) AS subject, baaLicenseeInterest AS obj FROM bsns_arr_area_licensee_hst) AS T2 WHERE T0.subject = T1.subject AND T1.subject = T2.subject;
